<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>FlagKinect</title></head><body>Human&nbsp;human;<br>PFont&nbsp;font,&nbsp;largeFont;<br>PImage&nbsp;left,&nbsp;right,&nbsp;none,&nbsp;both;<br>Pose&nbsp;pose;<br><font color="purple"><b>int</b></font>&nbsp;start;<br><font color="purple"><b>int</b></font>&nbsp;score;<br><font color="purple"><b>int</b></font>&nbsp;goal;<br><br><font color="#cc3300">//&nbsp;はじめに一度だけ実行される処理<br></font><font color="purple"><b>void</b></font>&nbsp;setup()&nbsp;{<br>&nbsp;&nbsp;human&nbsp;=&nbsp;<font color="purple"><b>new</b></font>&nbsp;Human();<br>&nbsp;&nbsp;human.showCaptureFrame(<font color="purple"><b>true</b></font>);<br>&nbsp;&nbsp;font&nbsp;=&nbsp;createFont(&quot;Meiryo&nbsp;UI&quot;,&nbsp;24,&nbsp;<font color="purple"><b>true</b></font>);<br>&nbsp;&nbsp;largeFont&nbsp;=&nbsp;createFont(&quot;Meiryo&nbsp;UI&quot;,&nbsp;40,&nbsp;<font color="purple"><b>true</b></font>);<br>&nbsp;&nbsp;size(640,&nbsp;640);<br>&nbsp;&nbsp;frameRate(15);<br>&nbsp;&nbsp;start&nbsp;=&nbsp;-1;<br>&nbsp;&nbsp;left&nbsp;=&nbsp;loadImage(&quot;left.png&quot;);<br>&nbsp;&nbsp;right&nbsp;=&nbsp;loadImage(&quot;right.png&quot;);<br>&nbsp;&nbsp;none&nbsp;=&nbsp;loadImage(&quot;none.png&quot;);<br>&nbsp;&nbsp;both&nbsp;=&nbsp;loadImage(&quot;both.png&quot;);<br>&nbsp;&nbsp;goal&nbsp;=&nbsp;(<font color="purple"><b>int</b></font>)&nbsp;random(0,&nbsp;4);<br>}<br><br><font color="#cc3300">//&nbsp;1秒に15回実行されつづける処理<br></font><font color="purple"><b>void</b></font>&nbsp;draw()&nbsp;{<br><br>&nbsp;&nbsp;<font color="#cc3300">//&nbsp;姿勢を取得<br></font>&nbsp;&nbsp;pose&nbsp;=&nbsp;human.getPose();<br><br>&nbsp;&nbsp;<font color="#cc3300">//&nbsp;画面に絵や得点を表示<br></font>&nbsp;&nbsp;clearBackground();&nbsp;<font color="#cc3300">//&nbsp;背景をクリア<br></font>&nbsp;&nbsp;showCommand();&nbsp;<font color="#cc3300">//&nbsp;指示内容の絵を表示<br></font>&nbsp;&nbsp;showScore();&nbsp;<font color="#cc3300">//&nbsp;得点を表示<br></font><br>&nbsp;&nbsp;<font color="#cc3300">//&nbsp;姿勢が取れなかったらここで終わる<br></font>&nbsp;&nbsp;<font color="#cc3300">//&nbsp;(正解判定に進まない)<br></font>&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(pose&nbsp;==&nbsp;<font color="purple"><b>null</b></font>)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>return</b></font>;<br>&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;<font color="#cc3300">//&nbsp;正解判定<br></font>&nbsp;&nbsp;<font color="purple"><b>boolean</b></font>&nbsp;ok&nbsp;=&nbsp;<font color="purple"><b>false</b></font>;<br>&nbsp;&nbsp;<font color="purple"><b>switch</b></font>&nbsp;(goal)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;0:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(pose.eq(<a href="./poses/New pose (3).txt"><img src="./poses/New pose (3).jpg" width="160" border="1" /></a>)))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;=&nbsp;<font color="purple"><b>true</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;1:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(pose.eq(<a href="./poses/New pose (4).txt"><img src="./poses/New pose (4).jpg" width="160" border="1" /></a>)))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;=&nbsp;<font color="purple"><b>true</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;2:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(pose.eq(<a href="./poses/New pose (2).txt"><img src="./poses/New pose (2).jpg" width="160" border="1" /></a>)))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;=&nbsp;<font color="purple"><b>true</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;3:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(pose.eq(<a href="./poses/New pose (5).txt"><img src="./poses/New pose (5).jpg" width="160" border="1" /></a>)))&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;=&nbsp;<font color="purple"><b>true</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;<font color="#cc3300">//&nbsp;姿勢が正しくなかったらここで終わる<br></font>&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(ok&nbsp;==&nbsp;<font color="purple"><b>false</b></font>)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>return</b></font>;<br>&nbsp;&nbsp;}<br><br>&nbsp;&nbsp;<font color="#cc3300">//&nbsp;正解!!<br></font>&nbsp;&nbsp;calcScore();<br>&nbsp;&nbsp;setNewGoal();<br>}<br><br><font color="#cc3300">//&nbsp;背景をクリア<br></font><font color="purple"><b>void</b></font>&nbsp;clearBackground()&nbsp;{<br>&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(pose&nbsp;==&nbsp;<font color="purple"><b>null</b></font>)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;background(200);<br>&nbsp;&nbsp;}&nbsp;<font color="purple"><b>else</b></font>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;background(255);<br>&nbsp;&nbsp;}<br>}<br><br><font color="#cc3300">//&nbsp;指示内容の絵を表示<br></font><font color="purple"><b>void</b></font>&nbsp;showCommand()&nbsp;{<br>&nbsp;&nbsp;textFont(largeFont);<br>&nbsp;&nbsp;textAlign(CENTER);<br>&nbsp;&nbsp;fill(0);<br>&nbsp;&nbsp;<font color="purple"><b>switch</b></font>&nbsp;(goal)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;0:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image(left,&nbsp;20,&nbsp;10);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(&quot;左手あげて！&quot;,&nbsp;320,&nbsp;610);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;1:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image(right,&nbsp;20,&nbsp;10);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(&quot;右手あげて！&quot;,&nbsp;320,&nbsp;610);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;2:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image(none,&nbsp;20,&nbsp;10);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(&quot;両手さげて！&quot;,&nbsp;320,&nbsp;610);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>case</b></font>&nbsp;3:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image(both,&nbsp;20,&nbsp;10);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text(&quot;両手あげて！&quot;,&nbsp;320,&nbsp;610);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>break</b></font>;<br>&nbsp;&nbsp;}<br>}<br><br><font color="#cc3300">//&nbsp;得点を表示<br></font><font color="purple"><b>void</b></font>&nbsp;showScore()&nbsp;{<br>&nbsp;&nbsp;textFont(font);<br>&nbsp;&nbsp;textAlign(LEFT);<br>&nbsp;&nbsp;fill(0);<br>&nbsp;&nbsp;text(&quot;得点:&nbsp;&quot;&nbsp;+&nbsp;score,&nbsp;10,&nbsp;30);<br>}<br><br><font color="#cc3300">//&nbsp;得点を計算<br></font><font color="purple"><b>void</b></font>&nbsp;calcScore()&nbsp;{<br>&nbsp;&nbsp;<font color="purple"><b>int</b></font>&nbsp;end&nbsp;=&nbsp;getTime();<br>&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(start&nbsp;&gt;=&nbsp;0)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>int</b></font>&nbsp;bonus&nbsp;=&nbsp;100&nbsp;-&nbsp;(end&nbsp;-&nbsp;start);<br>&nbsp;&nbsp;&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(bonus&nbsp;&gt;=&nbsp;0)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score&nbsp;+=&nbsp;bonus;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;start&nbsp;=&nbsp;end;<br>}<br><br><font color="#cc3300">//&nbsp;次のゴールを設定<br></font><font color="purple"><b>void</b></font>&nbsp;setNewGoal()&nbsp;{<br>&nbsp;&nbsp;<font color="purple"><b>int</b></font>&nbsp;newGoal&nbsp;=&nbsp;(<font color="purple"><b>int</b></font>)&nbsp;random(0,&nbsp;3);<br>&nbsp;&nbsp;<font color="purple"><b>if</b></font>&nbsp;(goal&nbsp;&lt;=&nbsp;newGoal)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;goal&nbsp;=&nbsp;newGoal&nbsp;+&nbsp;1;<br>&nbsp;&nbsp;}&nbsp;<font color="purple"><b>else</b></font>&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;goal&nbsp;=&nbsp;newGoal;<br>&nbsp;&nbsp;}<br>}<br><br><font color="#cc3300">//&nbsp;今の時刻を取得<br></font><font color="purple"><b>int</b></font>&nbsp;getTime()&nbsp;{<br>&nbsp;&nbsp;<font color="purple"><b>return</b></font>&nbsp;hour()&nbsp;*&nbsp;60&nbsp;*&nbsp;60&nbsp;+&nbsp;minute()&nbsp;*&nbsp;60&nbsp;+&nbsp;second();<br>}<br></body></html>